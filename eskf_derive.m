pkg load symbolic

syms q0 q1 q2 q3

X_delta_x = ...
[[1 0 0 0 0 0 0     0     0     0];
 [0 1 0 0 0 0 0     0     0     0];
 [0 0 1 0 0 0 0     0     0     0];
 [0 0 0 1 0 0 0     0     0     0];
 [0 0 0 0 1 0 0     0     0     0];
 [0 0 0 0 0 1 0     0     0     0];
 [0 0 0 0 0 0 0 -q1/2 -q2/2 -q3/2];
 [0 0 0 0 0 0 0  q0/2 -q3/2  q2/2];
 [0 0 0 0 0 0 0  q3/2  q0/2 -q1/2];
 [0 0 0 0 0 0 0 -q3/2  q1/2  q0/2]];

H_x_accel = ...
[[0 0 0 0 0 0 -2*q2  2*q3 -2*q0 2*q1];
 [0 0 0 0 0 0  2*q1  2*q0  2*q3 2*q2];
 [0 0 0 0 0 0  2*q0 -2*q1 -2*q2 2*q3]];

H_x_mag = ...
[[0 0 0 0 0 0  2*q0 2*q1 -2*q2 -2*q3];
 [0 0 0 0 0 0 -2*q3 2*q2  2*q1 -2*q0];
 [0 0 0 0 0 0  2*q2 2*q3  2*q0  2*q1]];

H_accel = H_x_accel * X_delta_x;
H_mag = H_x_mag * X_delta_x


